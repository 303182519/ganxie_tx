(function(){function squareDraw(){this.initialize.apply(this,arguments)}squareDraw.prototype={initialize:function(obj){this.id_dom=this.byId(obj.id_dom);this.suiji=this.byClass("suiji",this.id_dom)[0];this.prize_arr=obj.prize_arr;this.award_count=obj.prize_arr.length;this.round_count=obj.round_count||2;this.normal_speed=obj.normal_speed||400;this.up_speed=obj.up_speed||100;this.start_point=obj.start_point||6;this.end_point=obj.end_point||20,this.show_result=obj.show_result||function(){};this.timer_link=null},set_prize:function(prize){this.award_index=1;this.round_index=0;this.prize=prize;this.suiji.style.display="block";var prize_index=this.find_prize_index(prize);if(prize_index!=-1){prize_index=this.random_index(prize_index)+1;this.run_fn(prize_index)}},random_index:function(arr_index){var index=Math.floor(Math.random()*arr_index.length);return arr_index[index]},find_prize_index:function(prize){var arr=[];for(var i=0;i<this.award_count;i++){if(this.prize_arr[i]==prize){arr.push(i)}}return arr.length?arr:-1},run_fn:function(prize_index){this.suiji.className="suiji suiji_"+this.award_index;if(this.round_index>=this.round_count&&this.award_index==prize_index){this.show_result(this.prize);return false}var k=parseInt(this.award_index+(this.round_index*this.award_count));var speed=(k<this.start_point||k>this.end_point)?this.normal_speed:this.up_speed;if(this.award_index<this.award_count){this.award_index++}else{this.award_index=1;this.round_index++}var _this=this;this.timer_link=setTimeout(function(){_this.run_fn(prize_index)},speed)},byId:function(id){return typeof id==="string"?document.getElementById(id):id},byTagName:function(elem,obj){return(obj||document).getElementsByTagName(elem)},byClass:function(sClass,oPrent){var aClass=[],reClass=new RegExp("(^|\\s)"+sClass+"(\\s|$)"),aElem=this.byTagName("*",oPrent),len=aElem.length;for(var i=0;i<len;i++){reClass.test(aElem[i].className)&&aClass.push(aElem[i])}return aClass}};if(typeof module!=="undefined"&&module.exports){module.exports=squareDraw}else{if(typeof define==="function"&&define.cmd){define(function(){return squareDraw})}else{(function(){return this||(0,eval)("this")}()).squareDraw=squareDraw}}}());
